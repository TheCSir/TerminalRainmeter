[Rainmeter]
Author=CSir
Update=01
AccurateText=1
BackgroundMode=2
SolidColor=0,0,0,1
DynamicWindowSize=1

[Metadata]
Name=PowerOpt Changer
Version=2.0

[Variables]
; ── Darkish theme (matching TerminalStart) ──
ColorBg=13,13,13
ColorFg=224,224,224
ColorMuted=119,119,119
ColorBorder=51,51,51
ColorAccent=255,255,255
ColorHover=34,34,34
FontFace=JetBrains Mono
FontSizeSm=10
FontSizeXs=9

; ── Layout ──
W=190
SkinH=76

; ── Animation ──
FRAMES=8
EXCEED=7

; ── Icons (dark theme) ──
Icon1=#CURRENTPATH#ecoD.png
Icon2=#CURRENTPATH#balanceD.png
Icon3=#CURRENTPATH#highperfD.png
Icon4=#CURRENTPATH#turboD.png
Icon5=#CURRENTPATH#gearD.png

; ── Shortcut positions (inside border) ──
X=124
Y=32r

; ── Labels ──
Choice1=Eco
Choice2=Balanced
Choice3=High Perf.
Choice4=Turbo
Choice5=Settings

; ── Bulk show/hide ──
SHOWCONTENTS=[!ShowMeter Shortcut1][!ShowMeter Shortcut2][!ShowMeter Shortcut3][!ShowMeter Shortcut4][!ShowMeter Shortcut5]
HIDECONTENTS=[!HideMeter Shortcut1][!HideMeter Shortcut2][!HideMeter Shortcut3][!HideMeter Shortcut4][!HideMeter Shortcut5]

; ═══════════════════════════════════════════
; TUIBOX BORDER
; ═══════════════════════════════════════════

; ── Background fill (inside border) ──
[MeterBg]
Meter=Image
X=0
Y=7
W=#W#
H=(#SkinH# - 8)
SolidColor=#ColorBg#

; ── Border ──
[MeterBorderTop]
Meter=Image
X=0
Y=7
W=#W#
H=1
SolidColor=#ColorBorder#

[MeterBorderBottom]
Meter=Image
X=0
Y=(#SkinH# - 1)
W=#W#
H=1
SolidColor=#ColorBorder#

[MeterBorderLeft]
Meter=Image
X=0
Y=7
W=1
H=(#SkinH# - 7)
SolidColor=#ColorBorder#

[MeterBorderRight]
Meter=Image
X=(#W# - 1)
Y=7
W=1
H=(#SkinH# - 7)
SolidColor=#ColorBorder#

; ── Title bg mask (cuts through top border) ──
[MeterTitleBg]
Meter=Image
X=8
Y=1
W=90
H=14
SolidColor=#ColorBg#

; ── Title: "power.cfg" ──
[MeterTitle]
Meter=String
X=12
Y=0
FontFace=#FontFace#
FontSize=#FontSizeSm#
FontWeight=700
FontColor=#ColorMuted#
StringAlign=Left
StringCase=Lower
AntiAlias=1
Text=power.cfg
MouseOverAction=[!SetOption MeterTitle FontColor "#ColorAccent#"][!UpdateMeter MeterTitle][!Redraw]
MouseLeaveAction=[!SetOption MeterTitle FontColor "#ColorMuted#"][!UpdateMeter MeterTitle][!Redraw]

; ═══════════════════════════════════════════
; ANIMATION MEASURES
; ═══════════════════════════════════════════

[CLOSED]
Measure=Calc
Formula=0

[OPENED]
Measure=Calc
Formula=#FRAMES#

[STOP]
Measure=Calc
Formula=Counter

[HOLD]
Measure=Calc
Formula=HOLD = 0 ? STOP : HOLD
Disabled=1

[RESET]
Measure=Calc
Formula=STOP - HOLD
IfAboveValue=#EXCEED#
IfAboveAction=[!DisableMeasure HOLD]

[FORWARD]
Measure=Calc
MinValue=0
MaxValue=#FRAMES#
Formula=(STOP-HOLD < #FRAMES#) ? STOP-HOLD : 0
IfEqualValue=#EXCEED#
IfEqualAction=[!ShowMeter Aopened][!HideMeter Aforward][!DisableMeasure FORWARD][!ShowMeter Aclose]#SHOWCONTENTS#[!DisableMeasure HOLD][!Redraw]
Disabled=1

[REVERSE]
Measure=Calc
MinValue=0
MaxValue=#FRAMES#
Formula=(STOP-HOLD < #FRAMES#) ? #FRAMES#-(STOP-HOLD) : #EXCEED#
IfEqualValue=1
IfEqualAction=[!HideMeter Areverse][!DisableMeasure REVERSE][!ShowMeter Aopen][!DisableMeasure HOLD][!Redraw]
Disabled=1

; ═══════════════════════════════════════════
; ORIGINAL WIDGET CONTENT (offset +16x, +14y)
; ═══════════════════════════════════════════

; ── Main bar (collapsed state) ──
[Main]
Meter=IMAGE
ImageName=#CURRENTPATH#MainD.png
X=16
Y=14

; ── Animation frames ──
[Aforward]
Meter=BITMAP
MeasureName=FORWARD
BitmapImage=#CURRENTPATH#AnimationD.png
X=90
Y=60
BitmapFrames=#FRAMES#
Hidden=1

[Areverse]
Meter=BITMAP
MeasureName=REVERSE
BitmapImage=#CURRENTPATH#AnimationD.png
X=90
Y=60
BitmapFrames=#FRAMES#
Hidden=1

[Aopened]
Meter=BITMAP
MeasureName=OPENED
BitmapImage=#CURRENTPATH#AnimationD.png
X=90
Y=60
BitmapFrames=#FRAMES#
BitmapZeroFrame=1
Hidden=1

; ── Expand trigger ──
[Aopen]
Meter=IMAGE
ImageName=#CURRENTPATH#BGD.png
X=116
Y=40
LeftMouseDownAction=[!HideMeter Aopen][!EnableMeasure HOLD][!EnableMeasure FORWARD][!ShowMeter Aforward][!HideMeter TitleText][!Redraw]

; ── Collapse trigger ──
[Aclose]
Meter=IMAGE
ImageName=#CURRENTPATH#BG0D.png
X=116
Y=220
LeftMouseDownAction=#HIDECONTENTS#[!HideMeter Aclose][!EnableMeasure HOLD][!EnableMeasure REVERSE][!ShowMeter Areverse][!ShowMeter TitleText][!HideMeter Aopened]
Hidden=1

; ═══════════════════════════════════════════
; TOOLTIP LABELS (shown on icon hover)
; ═══════════════════════════════════════════

[1S]
Meter=String
FontFace=#FontFace#
FontSize=#FontSizeXs#
StringAlign=CENTER
FontColor=#ColorMuted#
X=66
Y=37
Text=#Choice1#
AntiAlias=1
Hidden=1

[2S]
Meter=String
FontFace=#FontFace#
FontSize=#FontSizeXs#
StringAlign=CENTER
FontColor=#ColorMuted#
X=66
Y=37
Text=#Choice2#
AntiAlias=1
Hidden=1

[3S]
Meter=String
FontFace=#FontFace#
FontSize=#FontSizeXs#
StringAlign=CENTER
FontColor=#ColorMuted#
X=66
Y=37
Text=#Choice3#
AntiAlias=1
Hidden=1

[4S]
Meter=String
FontFace=#FontFace#
FontSize=#FontSizeXs#
StringAlign=CENTER
FontColor=#ColorMuted#
X=66
Y=37
Text=#Choice4#
AntiAlias=1
Hidden=1

[5S]
Meter=String
FontFace=#FontFace#
FontSize=#FontSizeXs#
StringAlign=CENTER
FontColor=#ColorMuted#
X=66
Y=37
Text=#Choice5#
AntiAlias=1
Hidden=1

; ── Title text (visible when collapsed) ──
[TitleText]
Meter=STRING
FontFace=#FontFace#
FontSize=#FontSizeSm#
StringAlign=CENTER
FontColor=#ColorMuted#
X=66
Y=32
Text=
AntiAlias=1
StringStyle=BOLD

; ═══════════════════════════════════════════
; SHORTCUT ICONS (power plans + settings)
; ═══════════════════════════════════════════

[Shortcut1]
Meter=IMAGE
ImageName=#Icon1#
X=#X#
Y=66
Hidden=1
LeftMouseDownAction=[!Redraw]
LeftMouseUpAction=["C:\Windows\System32\powercfg.exe" -setactive a1841308-3541-4fab-bc81-f71556f20b4a]
MouseOverAction=[!ShowMeter 1S][!Redraw]
MouseLeaveAction=[!HideMeter 1S][!Redraw]

[Shortcut2]
Meter=IMAGE
ImageName=#Icon2#
X=#X#
Y=#Y#
Hidden=1
LeftMouseDownAction=[!Redraw]
LeftMouseUpAction=["C:\Windows\System32\powercfg.exe" -setactive 381b4222-f694-41f0-9685-ff5bb260df2e]
MouseOverAction=[!ShowMeter 2S][!Redraw]
MouseLeaveAction=[!HideMeter 2S][!Redraw]

[Shortcut3]
Meter=IMAGE
ImageName=#Icon3#
X=#X#
Y=#Y#
Hidden=1
LeftMouseDownAction=[!Redraw]
LeftMouseUpAction=["C:\Windows\System32\powercfg.exe" -setactive 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c]
MouseOverAction=[!ShowMeter 3S][!Redraw]
MouseLeaveAction=[!HideMeter 3S][!Redraw]

[Shortcut4]
Meter=IMAGE
ImageName=#Icon4#
X=#X#
Y=#Y#
Hidden=1
LeftMouseDownAction=[!Redraw]
LeftMouseUpAction=["C:\Windows\System32\powercfg.exe" -setactive 976e12b9-908d-43b9-87cc-78834ade703c]
MouseOverAction=[!ShowMeter 4S][!Redraw]
MouseLeaveAction=[!HideMeter 4S][!Redraw]

[Shortcut5]
Meter=IMAGE
ImageName=#Icon5#
X=#X#
Y=#Y#
Hidden=1
LeftMouseDownAction=[!Redraw]
LeftMouseUpAction=["ms-settings:powersleep"]
MouseOverAction=[!ShowMeter 5S][!Redraw]
MouseLeaveAction=[!HideMeter 5S][!Redraw]
